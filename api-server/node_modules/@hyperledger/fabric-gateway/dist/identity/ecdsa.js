"use strict";
/*
 * Copyright 2023 IBM All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.newECPrivateKeySigner = newECPrivateKeySigner;
const nist_1 = require("@noble/curves/nist");
const nist_2 = require("@noble/curves/nist");
const namedCurves = {
    'P-256': nist_1.p256,
    'P-384': nist_2.p384,
};
function newECPrivateKeySigner(key) {
    const { crv, d } = key.export({ format: 'jwk' });
    if (!crv) {
        throw new Error('Missing EC curve name');
    }
    if (!d) {
        throw new Error('Missing EC private key value');
    }
    const curve = getCurve(crv);
    const privateKey = Buffer.from(d, 'base64url');
    return (digest) => {
        const signature = curve.sign(digest, privateKey, { lowS: true });
        return Promise.resolve(signature.toBytes('der'));
    };
}
function getCurve(name) {
    const curve = namedCurves[name];
    if (!curve) {
        throw new Error(`Unsupported curve: ${name}`);
    }
    return curve;
}
//# sourceMappingURL=ecdsa.js.map